reg <- reg %>%
rename(mpio = `CÓDIGO DANE DEL MUNICIPIO`)
reg$MPIO_CDPMP <- sprintf("%.3f", reg$mpio) #Codigo municipio should have 5 digits
reg$MPIO_CDPMP <- gsub("\\.", "", reg$MPIO_CDPMP)
reg$MPIO_CDPMP <- ifelse(nchar(reg$MPIO_CDPMP) == 4, sprintf("0%s", reg$MPIO_CDPMP), reg$MPIO_CDPMP)
unique(reg$REGION)
reg <- reg %>%
mutate(Cardinal = case_when(
REGION %in% c('Región Caribe', 'Región Eje Cafetero - Antioquia') ~ 'North',
REGION %in% c('Región Centro Oriente', 'Región Llano') ~ 'East',
REGION == 'Región Centro Sur' ~ 'South',
REGION == 'Región Pacífico' ~ 'West',
TRUE ~ NA_character_
))
# V-Dem merge:
# "less free and fair subnational elections"
reg <- reg %>%
mutate(elsnlfc = case_when(
Cardinal == "North" ~ v13_col_sn_2018$v2elsnlfc_6,
Cardinal == "South" ~ v13_col_sn_2018$v2elsnlfc_7,
Cardinal == "West" ~ v13_col_sn_2018$v2elsnlfc_8,
Cardinal == "East" ~ v13_col_sn_2018$v2elsnlfc_9,
TRUE ~ NA_real_
))
# "more free and fair subnational elections"
reg <- reg %>%
mutate(elsnmrfc = case_when(
Cardinal == "North" ~ v13_col_sn_2018$v2elsnmrfc_6,
Cardinal == "South" ~ v13_col_sn_2018$v2elsnmrfc_7,
Cardinal == "West" ~ v13_col_sn_2018$v2elsnmrfc_8,
Cardinal == "East" ~ v13_col_sn_2018$v2elsnmrfc_9,
TRUE ~ NA_real_
))
# "stronger civil liberties"
reg <- reg %>%
mutate(clrgstch = case_when(
Cardinal == "North" ~ v13_col_sn_2018$v2clrgstch_6,
Cardinal == "South" ~ v13_col_sn_2018$v2clrgstch_7,
Cardinal == "West" ~ v13_col_sn_2018$v2clrgstch_8,
Cardinal == "East" ~ v13_col_sn_2018$v2clrgstch_9,
TRUE ~ NA_real_
))
# "weaker civil liberties"
reg <- reg %>%
mutate(clrgwkch = case_when(
Cardinal == "North" ~ v13_col_sn_2018$v2clrgwkch_6,
Cardinal == "South" ~ v13_col_sn_2018$v2clrgwkch_7,
Cardinal == "West" ~ v13_col_sn_2018$v2clrgwkch_8,
Cardinal == "East" ~ v13_col_sn_2018$v2clrgwkch_9,
TRUE ~ NA_real_
))
# rename variables
reg <- reg %>%
select(1|6:11) %>%
rename(FID_6t9 = FID) %>%
rename(Card_6t9 = Cardinal) %>%
rename(elsnl_6t9 = elsnlfc) %>%
rename(elsnmr_6t9 = elsnmrfc) %>%
rename(clrgst_6t9 = clrgstch) %>%
rename(clrgwk_6t9 = clrgwkch)
# Select and rename variables
reg <- reg %>%
select(1|6:11) %>%
rename(Card_6t9 = Cardinal) %>%
rename(elsnl_6t9 = elsnlfc) %>%
rename(elsnmr_6t9 = elsnmrfc) %>%
rename(clrgst_6t9 = clrgstch) %>%
rename(clrgwk_6t9 = clrgwkch)
# For sf (R), merge this data to shapefile
col <- merge(col, reg, by = "MPIO_CDPMP", all.x = TRUE)
# For ArcMaps, merge base-layer dataset to obtain FID variable (for later integration with ArcMaps)
reg <- merge(reg, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
reg <- reg %>%
rename(FID_6t9 = FID)
#Belen de Bajira (Choco) does not have an FID number, which causes problems in ArcMap when merging. This municipality was only recently inaugurated.
reg <- reg[complete.cases(reg$FID_6t9), ]
# Export the final merge to a .csv file that can be read into ArcMaps:
write.csv(reg, file = "G:/My Drive/git/snvdem24/data/geospatial/2018pmq/6-9_Cardinal/CD18_6-9.csv", row.names = FALSE)
rm(list = df2rm)
#clean things up for next variable
df2rm = c("reg", "df2rm")
rm(list = df2rm)
# municipal-level data for distance to capital city
CEDE18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/4-5_DisCapital/PANEL_CARACTERISTICAS_GENERALES(2021).xlsx")
colnames(CEDE18)[3] = "MPIO_CDPMP"
colnames(CEDE18)[7] = "Year"
CEDE18 <- CEDE18 %>%
filter(Year == 2018)
# this data set also contains important descriptive information (department, province, rurality index) that we will hang onto
CEDE18 <- CEDE18[c("MPIO_CDPMP", "depto", "provincia", "indrural", "discapital", "disbogota")]
# Because the import creates a numeric field for DANE code, we must convert this numeric variable to character and then assure each observation has the corresponding 5 digits
CEDE18$MPIO_CDPMP <- as.character(CEDE18$MPIO_CDPMP)
# Add a 0 before values with 4 digits only
CEDE18$MPIO_CDPMP <- ifelse(nchar(CEDE18$MPIO_CDPMP) == 4, paste0("0", CEDE18$MPIO_CDPMP), CEDE18$MPIO_CDPMP)
# National capital:
# "less free and fair subnational elections"
CEDE18 <- CEDE18 %>%
mutate(elsnl_4t5n = case_when(
disbogota == 0 ~ v13_col_sn_2018$v2elsnlfc_4,
disbogota > 0 ~ v13_col_sn_2018$v2elsnlfc_5,
TRUE ~ NA_real_
))
# "more free and fair subnational elections"
CEDE18 <- CEDE18 %>%
mutate(elsnmr_4t5n = case_when(
disbogota == 0 ~ v13_col_sn_2018$v2elsnmrfc_4,
disbogota > 0 ~ v13_col_sn_2018$v2elsnmrfc_5,
TRUE ~ NA_real_
))
# "stronger civil liberties"
CEDE18 <- CEDE18 %>%
mutate(clrgst_4t5n = case_when(
disbogota == 0 ~ v13_col_sn_2018$v2clrgstch_4,
disbogota > 0 ~ v13_col_sn_2018$v2clrgstch_5,
TRUE ~ NA_real_
))
# "weaker civil liberties"
CEDE18 <- CEDE18 %>%
mutate(clrgwk_4t5n = case_when(
disbogota == 0 ~ v13_col_sn_2018$v2clrgwkch_4,
disbogota > 0 ~ v13_col_sn_2018$v2clrgwkch_5,
TRUE ~ NA_real_
))
# Department capital:
# "less free and fair subnational elections"
CEDE18 <- CEDE18 %>%
mutate(elsnl_4t5d = case_when(
discapital == 0 ~ v13_col_sn_2018$v2elsnlfc_4,
discapital > 0 ~ v13_col_sn_2018$v2elsnlfc_5,
TRUE ~ NA_real_
))
# "more free and fair subnational elections"
CEDE18 <- CEDE18 %>%
mutate(elsnmr_4t5d = case_when(
discapital == 0 ~ v13_col_sn_2018$v2elsnmrfc_4,
discapital > 0 ~ v13_col_sn_2018$v2elsnmrfc_5,
TRUE ~ NA_real_
))
# "stronger civil liberties"
CEDE18 <- CEDE18 %>%
mutate(clrgst_4t5d = case_when(
discapital == 0 ~ v13_col_sn_2018$v2clrgstch_4,
discapital > 0 ~ v13_col_sn_2018$v2clrgstch_5,
TRUE ~ NA_real_
))
# "weaker civil liberties"
CEDE18 <- CEDE18 %>%
mutate(clrgwk_4t5d = case_when(
discapital == 0 ~ v13_col_sn_2018$v2clrgwkch_4,
discapital > 0 ~ v13_col_sn_2018$v2clrgwkch_5,
TRUE ~ NA_real_
))
# For sf (R), merge this data to shapefile
col <- merge(col, CEDE18, by = "MPIO_CDPMP", all.x = TRUE)
# merge base-layer dataset to obtain FID variable
CEDE18 <- merge(CEDE18, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
CEDE18 <- CEDE18 %>%
rename(discap4t5 = discapital) %>%
rename(disbog4t5 = disbogota) %>%
rename(FID_4t5 = FID)
# For ArcMaps, export the final merge to a .csv file
write.csv(CEDE18, file = "G:/My Drive/git/snvdem24/data/geospatial/2018pmq/4-5_DisCapital/DC18_4-5.csv", row.names = FALSE)
#clean things up for next variable
df2rm = c("CEDE18", "df2rm")
rm(list = df2rm)
# municipal-level data for distance to capital city
IR18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/0-1_Rurality/PANEL_CARACTERISTICAS_GENERALES(2021).xlsx")
colnames(IR18)[3] = "MPIO_CDPMP"
colnames(IR18)[7] = "Year"
IR18 <- IR18 %>%
filter(Year == 2018)
# this data set also contains important descriptive information (department, province, rurality index) that we will hang onto
IR18 <- IR18[c("MPIO_CDPMP", "depto", "provincia", "indrural")]
# Because the import creates a numeric field for DANE code, we must convert this numeric variable to character and then assure each observation has the corresponding 5 digits
IR18$MPIO_CDPMP <- as.character(IR18$MPIO_CDPMP)
# Add a 0 before values with 4 digits only
IR18$MPIO_CDPMP <- ifelse(nchar(IR18$MPIO_CDPMP) == 4, paste0("0", IR18$MPIO_CDPMP), IR18$MPIO_CDPMP)
# make a clean slate
rm(list = ls())
# load needed packages
library(tidyverse)
library(vdemdata)
# Create a data frame of version 13 dataset:
v13 <- vdem
# this df appears to be the same as MC's "full + others" data set: read_dta("C:/Users/mcoppedg/Dropbox/MC/VDemFiles/Archive/V13/V-Dem-CY-Full+Others/V-Dem-CY-Full+Others-v13.dta")
# Filter to just Colombia since 1899:
v13_col <- filter(v13, country_name=="Colombia" & year > 1899)
# Select just the ID and subnational variables
# (Note: v2elsnless and v2elsnmore are not in this df. We will make sure to
# include them in our request to the data manager.)
v13_col_sn <- v13_col %>%
select(country_id, country_name, country_text_id, historical_date, year,
v2elsnlfc_0:v2elsnlfc_21, v2elsnmrfc_0:v2elsnmrfc_21,
v2clrgstch_0:v2clrgstch_21, v2clrgwkch_0:v2clrgwkch_21)
# Listing the variable names to check our work:
#names(v13_col_sn)
# Export the result to a CSV file:
#write.csv(v13_col_sn, file = "v13_col_sn.csv")
# create subset of V-Dem data for 2018
v13_col_sn_2018 <- subset(v13_col_sn, year == 2018)
v13_col_sn_2018 <- v13_col_sn_2018 %>%
select(-matches("_17$|_18$|_19$|_20$|_21$")) # remove responses not relevant for Colombia
df2rm = c("v13", "v13_col", "v13_col_sn", "df2rm")
rm(list = df2rm)
col <- st_read("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/BaseLayer/MGN_ANM_MPIOS.shp")
col <- col %>%
select(1:8)
library(readxl)
MGN18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/MGN_ANM_MPIOS/MGN18.xls")
# We select only relevant variables for merging purposes.
# colnames(MGN18)
MGN18 <- MGN18 %>%
select(1:7)
# we merge the FID variable to our main shapefile
col <- merge(col, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
# municipal-level data for distance to capital city
IR18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/0-1_Rurality/PANEL_CARACTERISTICAS_GENERALES(2021).xlsx")
colnames(IR18)[3] = "MPIO_CDPMP"
colnames(IR18)[7] = "Year"
IR18 <- IR18 %>%
filter(Year == 2018)
# this data set also contains important descriptive information (department, province) that we will hang onto
IR18 <- IR18[c("MPIO_CDPMP", "depto", "provincia", "indrural")]
# Because the import creates a numeric field for DANE code, we must convert this numeric variable to character and then assure each observation has the corresponding 5 digits
IR18$MPIO_CDPMP <- as.character(IR18$MPIO_CDPMP)
# Add a 0 before values with 4 digits only
IR18$MPIO_CDPMP <- ifelse(nchar(IR18$MPIO_CDPMP) == 4, paste0("0", IR18$MPIO_CDPMP), IR18$MPIO_CDPMP)
# "less free and fair subnational elections"
IR18 <- IR18 %>%
mutate(elsnl_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2elsnlfc_0,
indrural < 0.50 ~ v13_col_sn_2018$v2elsnlfc_1,
TRUE ~ NA_real_
))
# "more free and fair subnational elections"
IR18 <- IR18 %>%
mutate(elsnmr_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2elsnmrfc_0,
indrural < 0.50 ~ v13_col_sn_2018$v2elsnmrfc_1,
TRUE ~ NA_real_
))
# "stronger civil liberties"
IR18 <- IR18 %>%
mutate(clrgst_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2clrgstch_0,
indrural < 0.50 ~ v13_col_sn_2018$v2clrgstch_1,
TRUE ~ NA_real_
))
# "weaker civil liberties"
IR18 <- IR18 %>%
mutate(clrgwk_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2clrgwkch_0,
indrural < 0.50 ~ v13_col_sn_2018$v2clrgwkch_1,
TRUE ~ NA_real_
))
# For sf (R), merge this data to shapefile
col <- merge(col, IR18, by = "MPIO_CDPMP", all.x = TRUE)
# merge base-layer dataset to obtain FID variable
IR18 <- merge(IR18, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
IR18 <- IR18 %>%
rename(indrur0t1) %>%
rename(FID_0t1 = FID)
IR18 <- IR18 %>%
rename(indrur0t1 = indrural) %>%
rename(FID_0t1 = FID)
# For ArcMaps, export the final merge to a .csv file
write.csv(IR18, file = "G:/My Drive/git/snvdem24/data/geospatial/2018pmq/0-1_Rurality/IR18_0-1.csv", row.names = FALSE)
#clean things up for next variable
df2rm = c("IR18", "df2rm")
rm(list = df2rm)
usethis::create_github_token()
gitcreds::gitcreds_set()
knitr::opts_chunk$set(echo = TRUE)
setwd("G:/My Drive/git/snvdem24")
# make a clean slate
rm(list = ls())
# load needed packages
library(tidyverse)
library(vdemdata)
# Create a data frame of version 13 dataset:
v13 <- vdem
# this df appears to be the same as MC's "full + others" data set: read_dta("C:/Users/mcoppedg/Dropbox/MC/VDemFiles/Archive/V13/V-Dem-CY-Full+Others/V-Dem-CY-Full+Others-v13.dta")
# Filter to just Colombia since 1899:
v13_col <- filter(v13, country_name=="Colombia" & year > 1899)
# Select just the ID and subnational variables
# (Note: v2elsnless and v2elsnmore are not in this df. We will make sure to
# include them in our request to the data manager.)
v13_col_sn <- v13_col %>%
select(country_id, country_name, country_text_id, historical_date, year,
v2elsnlfc_0:v2elsnlfc_21, v2elsnmrfc_0:v2elsnmrfc_21,
v2clrgstch_0:v2clrgstch_21, v2clrgwkch_0:v2clrgwkch_21)
# Listing the variable names to check our work:
#names(v13_col_sn)
# Export the result to a CSV file:
#write.csv(v13_col_sn, file = "v13_col_sn.csv")
# create subset of V-Dem data for 2018
v13_col_sn_2018 <- subset(v13_col_sn, year == 2018)
v13_col_sn_2018 <- v13_col_sn_2018 %>%
select(-matches("_17$|_18$|_19$|_20$|_21$")) # remove responses not relevant for Colombia
df2rm = c("v13", "v13_col", "v13_col_sn", "df2rm")
rm(list = df2rm)
col <- st_read("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/BaseLayer/MGN_ANM_MPIOS.shp")
# municipal-level data for distance to capital city
IR18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/0-1_Rurality/PANEL_CARACTERISTICAS_GENERALES(2021).xlsx")
library(readxl)
library(sf)
col <- st_read("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/BaseLayer/MGN_ANM_MPIOS.shp")
col <- col %>%
select(1:8)
library(readxl)
MGN18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/MGN_ANM_MPIOS/MGN18.xls")
# We select only relevant variables for merging purposes.
# colnames(MGN18)
MGN18 <- MGN18 %>%
select(1:7)
# we merge the FID variable to our main shapefile
col <- merge(col, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
# municipal-level data for distance to capital city
IR18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/0-1_Rurality/PANEL_CARACTERISTICAS_GENERALES(2021).xlsx")
colnames(IR18)[3] = "MPIO_CDPMP"
colnames(IR18)[7] = "Year"
IR18 <- IR18 %>%
filter(Year == 2018)
# this data set also contains important descriptive information (department, province) that we will hang onto
IR18 <- IR18[c("MPIO_CDPMP", "depto", "provincia", "indrural")]
# Because the import creates a numeric field for DANE code, we must convert this numeric variable to character and then assure each observation has the corresponding 5 digits
IR18$MPIO_CDPMP <- as.character(IR18$MPIO_CDPMP)
# Add a 0 before values with 4 digits only
IR18$MPIO_CDPMP <- ifelse(nchar(IR18$MPIO_CDPMP) == 4, paste0("0", IR18$MPIO_CDPMP), IR18$MPIO_CDPMP)
# "less free and fair subnational elections"
IR18 <- IR18 %>%
mutate(elsnl_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2elsnlfc_0,
indrural < 0.50 ~ v13_col_sn_2018$v2elsnlfc_1,
TRUE ~ NA_real_
))
# "more free and fair subnational elections"
IR18 <- IR18 %>%
mutate(elsnmr_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2elsnmrfc_0,
indrural < 0.50 ~ v13_col_sn_2018$v2elsnmrfc_1,
TRUE ~ NA_real_
))
# "stronger civil liberties"
IR18 <- IR18 %>%
mutate(clrgst_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2clrgstch_0,
indrural < 0.50 ~ v13_col_sn_2018$v2clrgstch_1,
TRUE ~ NA_real_
))
# "weaker civil liberties"
IR18 <- IR18 %>%
mutate(clrgwk_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2clrgwkch_0,
indrural < 0.50 ~ v13_col_sn_2018$v2clrgwkch_1,
TRUE ~ NA_real_
))
IR18 <- IR18 %>%
mutate(Rural0t1 = case_when(
indrural > 0.50 == "Rural",
IR18 <- IR18 %>%
mutate(Rural0t1 = case_when(
indrural > 0.50 = "Rural",
IR18 <- IR18 %>%
mutate(Rural0t1 = case_when(
indrural > 0.50 ~ "Rural",
indrural < 0.50 ~ "Urban",
TRUE ~ NA_real_
))
IR18 <- IR18 %>%
mutate(Rural0t1 = case_when(
indrural > 0.50 ~ "Rural",
indrural < 0.50 ~ "Urban",
TRUE ~ NA_character_
))
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*elsnl_0t1)+((1-indrural)*(1-elsnl_0t1))) %>%
mutate(em_0t1x = (indrural*elsnmr_0t1)+((1-indrural)*(1-elsnmr_0t1))) %>%
mutate(cs_0t1x = (indrural*clrgst_0t1)+((1-indrural)*(1-clrgst_0t1))) %>%
mutate(cw_0t1x = (indrural*clrgwk_0t1)+((1-indrural)*(1-clrgwk_0t1)))
View(IR18)
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*(1-elsnl_0t1))+((1-indrural)*elsnl_0t1)) %>%
mutate(em_0t1x = (indrural*(1-elsnmr_0t1))+((1-indrural)*elsnmr_0t1)) %>%
mutate(cs_0t1x = (indrural*(1-clrgst_0t1))+((1-indrural)*clrgst_0t1)) %>%
mutate(cw_0t1x = (indrural*(1-clrgwk_0t1))+((1-indrural)*clrgwk_0t1))
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*elsnl_0t1))+((1-indrural)*(1-elsnl_0t1))
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*elsnl_0t1)+((1-indrural)*(1-elsnl_0t1))) %>%
mutate(em_0t1x = (indrural*elsnmr_0t1)+((1-indrural)*(1-elsnmr_0t1))) %>%
mutate(cs_0t1x = (indrural*clrgst_0t1)+((1-indrural)*(1-clrgst_0t1))) %>%
mutate(cw_0t1x = (indrural*clrgwk_0t1)+((1-indrural)*(1-clrgwk_0t1)))
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*v13_col_sn_2018$v2elsnlfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnlfc_1)) %>%
mutate(em_0t1x = (indrural*elsnmr_0t1)+((1-indrural)*(1-elsnmr_0t1))) %>%
mutate(cs_0t1x = (indrural*clrgst_0t1)+((1-indrural)*(1-clrgst_0t1))) %>%
mutate(cw_0t1x = (indrural*clrgwk_0t1)+((1-indrural)*(1-clrgwk_0t1)))
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*v13_col_sn_2018$v2elsnlfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnlfc_1)) %>%
mutate(em_0t1x = (indrural*v13_col_sn_2018$v2elsnmrfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnmrfc_1)) %>%
mutate(cs_0t1x = (indrural*v13_col_sn_2018$v2clrgstch_0)+((1-indrural)*v13_col_sn_2018$v2clrgstch_1)) %>%
mutate(cw_0t1x = (indrural*v13_col_sn_2018$v2clrgwkch_0)+((1-indrural)*v13_col_sn_2018$v2clrgwkch_1)) %>%
```
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*v13_col_sn_2018$v2elsnlfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnlfc_1)) %>%
mutate(em_0t1x = (indrural*v13_col_sn_2018$v2elsnmrfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnmrfc_1)) %>%
mutate(cs_0t1x = (indrural*v13_col_sn_2018$v2clrgstch_0)+((1-indrural)*v13_col_sn_2018$v2clrgstch_1)) %>%
mutate(cw_0t1x = (indrural*v13_col_sn_2018$v2clrgwkch_0)+((1-indrural)*v13_col_sn_2018$v2clrgwkch_1))
knitr::opts_chunk$set(echo = TRUE)
setwd("G:/My Drive/git/snvdem24")
# make a clean slate
rm(list = ls())
# load needed packages
library(tidyverse)
library(vdemdata)
# Create a data frame of version 13 dataset:
v13 <- vdem
# this df appears to be the same as MC's "full + others" data set: read_dta("C:/Users/mcoppedg/Dropbox/MC/VDemFiles/Archive/V13/V-Dem-CY-Full+Others/V-Dem-CY-Full+Others-v13.dta")
# Filter to just Colombia since 1899:
v13_col <- filter(v13, country_name=="Colombia" & year > 1899)
# Select just the ID and subnational variables
# (Note: v2elsnless and v2elsnmore are not in this df. We will make sure to
# include them in our request to the data manager.)
v13_col_sn <- v13_col %>%
select(country_id, country_name, country_text_id, historical_date, year,
v2elsnlfc_0:v2elsnlfc_21, v2elsnmrfc_0:v2elsnmrfc_21,
v2clrgstch_0:v2clrgstch_21, v2clrgwkch_0:v2clrgwkch_21)
# Listing the variable names to check our work:
#names(v13_col_sn)
# Export the result to a CSV file:
#write.csv(v13_col_sn, file = "v13_col_sn.csv")
# create subset of V-Dem data for 2018
v13_col_sn_2018 <- subset(v13_col_sn, year == 2018)
v13_col_sn_2018 <- v13_col_sn_2018 %>%
select(-matches("_17$|_18$|_19$|_20$|_21$")) # remove responses not relevant for Colombia
df2rm = c("v13", "v13_col", "v13_col_sn", "df2rm")
rm(list = df2rm)
library(sf)
col <- st_read("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/BaseLayer/MGN_ANM_MPIOS.shp")
col <- col %>%
select(1:8)
library(readxl)
MGN18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/MGN_ANM_MPIOS/MGN18.xls")
# We select only relevant variables for merging purposes.
# colnames(MGN18)
MGN18 <- MGN18 %>%
select(1:7)
# we merge the FID variable to our main shapefile
col <- merge(col, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
# municipal-level data for distance to capital city
IR18 <- read_excel("G:/My Drive/git/snvdem24/data/geospatial/2018pmq/0-1_Rurality/PANEL_CARACTERISTICAS_GENERALES(2021).xlsx")
colnames(IR18)[3] = "MPIO_CDPMP"
colnames(IR18)[7] = "Year"
IR18 <- IR18 %>%
filter(Year == 2018)
# this data set also contains important descriptive information (department, province) that we will hang onto
IR18 <- IR18[c("MPIO_CDPMP", "depto", "provincia", "indrural")]
# Because the import creates a numeric field for DANE code, we must convert this numeric variable to character and then assure each observation has the corresponding 5 digits
IR18$MPIO_CDPMP <- as.character(IR18$MPIO_CDPMP)
# Add a 0 before values with 4 digits only
IR18$MPIO_CDPMP <- ifelse(nchar(IR18$MPIO_CDPMP) == 4, paste0("0", IR18$MPIO_CDPMP), IR18$MPIO_CDPMP)
# Option #1: interact V-Dem with rural index score
#For example, a high rural index multiplied by a high proportion of V-Dem's response will produce correspondingly high scores. This may occur with the values for less free and fair elections for rural (.875) vs. urban (.125) areas.
# ([indrur0t1]*Rural)+((1-[indrur0t1])*Urban)
# .80*.875 + .20*.125
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*v13_col_sn_2018$v2elsnlfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnlfc_1)) %>%
mutate(em_0t1x = (indrural*v13_col_sn_2018$v2elsnmrfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnmrfc_1)) %>%
mutate(cs_0t1x = (indrural*v13_col_sn_2018$v2clrgstch_0)+((1-indrural)*v13_col_sn_2018$v2clrgstch_1)) %>%
mutate(cw_0t1x = (indrural*v13_col_sn_2018$v2clrgwkch_0)+((1-indrural)*v13_col_sn_2018$v2clrgwkch_1))
# Option #2: we dichotomize the rurality score and assign the corresponding V-Dem score
# "less free and fair subnational elections"
IR18 <- IR18 %>%
mutate(elsnl_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2elsnlfc_0,
indrural < 0.50 ~ v13_col_sn_2018$v2elsnlfc_1,
TRUE ~ NA_real_
))
# "more free and fair subnational elections"
IR18 <- IR18 %>%
mutate(elsnmr_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2elsnmrfc_0,
indrural < 0.50 ~ v13_col_sn_2018$v2elsnmrfc_1,
TRUE ~ NA_real_
))
# "stronger civil liberties"
IR18 <- IR18 %>%
mutate(clrgst_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2clrgstch_0,
indrural < 0.50 ~ v13_col_sn_2018$v2clrgstch_1,
TRUE ~ NA_real_
))
# "weaker civil liberties"
IR18 <- IR18 %>%
mutate(clrgwk_0t1 = case_when(
indrural > 0.50 ~ v13_col_sn_2018$v2clrgwkch_0,
indrural < 0.50 ~ v13_col_sn_2018$v2clrgwkch_1,
TRUE ~ NA_real_
))
# For sf (R), merge this data to shapefile
col <- merge(col, IR18, by = "MPIO_CDPMP", all.x = TRUE)
# merge base-layer dataset to obtain FID variable
IR18 <- merge(IR18, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
IR18 <- IR18 %>%
rename(indrur0t1 = indrural) %>%
rename(FID_0t1 = FID)
# For ArcMaps, export the final merge to a .csv file
write.csv(IR18, file = "G:/My Drive/git/snvdem24/data/geospatial/2018pmq/0-1_Rurality/IR18_0-1.csv", row.names = FALSE)
#clean things up for next variable
df2rm = c("IR18", "df2rm")
rm(list = df2rm)
