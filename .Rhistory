"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
ind <- c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)"))
vdem_op <- data.frame(
id <- seq(0, 17, 1), stringsAsFactors = FALSE,
rn <- c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
ind <- c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)"))
vdem_op <- data.frame(
id <- seq(0, 16, 1), stringsAsFactors = FALSE,
rn <- c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
ind <- c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)", "Presidential margin of victory (Registraduria)"))
mf <- flextable(vdem_op)
library(flextable)
mf <- flextable(vdem_op)
mf <- theme_box(vdem_op)
mf <- theme_box(mf)
merge_v(mf, j = ~ ind)
merge_v(mf, j = ~ vdem_op$ind)
mf
vdem_op <- data.frame(
id = seq(0, 16, 1), stringsAsFactors = FALSE,
rn = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
ind = c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)", "Presidential margin of victory (Registraduria)"))
mf <- flextable(vdem_op)
mf <- theme_box(mf)
mf <- theme_box(mf)
mf
merge_v(mf, j = ~ $ind)
merge_v(mf, j = ~ ind)
set_table_properties(mf, layout = "autofit")
merge_v(mf, j = ~ ind)
mf <- merge_v(mf, j = ~ ind) %>%
set_table_properties(mf, layout = "autofit")
merge_v(mf, j = ~ ind)
set_table_properties(mf, layout = "autofit")
mf
merge_v(mf, j = ~ ind)
set_table_properties(mf, layout = "autofit")
mf %>% autofit()
mf2 <- merge_v(mf, j = ~ ind) %>%
set_table_properties(mf, layout = "autofit")
library(dplyr)
mf2 <- merge_v(mf, j = ~ ind) %>%
set_table_properties(mf, layout = "autofit")
mf <- flextable(vdem_op)
mf <- theme_box(mf)
mf2 <- merge_v(mf, j = ~ ind) %>%
set_table_properties(mf, layout = "autofit")
mf <- merge_v(mf, j = ~ ind) %>%
set_table_properties(mf, layout = "autofit")
mf <- merge_v(mf, j = ~ ind) %>%
width(mf, layout = "autofit")
mf <- merge_v(mf, j = ~ ind) %>%
width(mf = "ind", width = 1)
mf <- merge_v(mf, j = ~ ind) %>%
width(mf, width = 1)
mf <- merge_v(mf, j = ~ ind)
mf
knitr::opts_chunk$set(echo = TRUE)
setwd("G:/Shared drives/snvdem/snvdem24/data/geospatial/2018pmq")
library(flextable)
library(dplyr)
vdem_op <- data.frame(
id = seq(0, 16, 1), stringsAsFactors = FALSE,
rn = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
ind = c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)", "Presidential margin of victory (Registraduria)"))
mf <- flextable(vdem_op)
mf <- theme_box(mf)
mf <- merge_v(mf, j = ~ ind)
mf
ft_merge <- flextable(survey)
knitr::opts_chunk$set(echo = TRUE)
setwd("G:/Shared drives/snvdem/snvdem24/data/geospatial/2018pmq")
library(flextable)
library(dplyr)
vdem_op <- data.frame(
id = seq(0, 16, 1), stringsAsFactors = FALSE,
rn = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
ind = c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)", "Presidential margin of victory (Registraduria)"))
mf <- flextable(vdem_op)
mf <- theme_box(mf)
mf <- merge_v(mf, j = ~ ind)
mf
# make a clean slate
rm(list = ls())
# load needed packages
library(tidyverse)
library(vdemdata)
# Create a data frame of version 13 dataset:
v13 <- vdem
# this df appears to be the same as MC's "full + others" data set: read_dta("C:/Users/mcoppedg/Dropbox/MC/VDemFiles/Archive/V13/V-Dem-CY-Full+Others/V-Dem-CY-Full+Others-v13.dta")
# Filter to just Colombia since 1899:
v13_col <- filter(v13, country_name=="Colombia" & year > 1899)
# Select just the ID and subnational variables
# (Note: v2elsnless and v2elsnmore are not in this df. We will make sure to
# include them in our request to the data manager.)
v13_col_sn <- v13_col %>%
select(country_id, country_name, country_text_id, historical_date, year,
v2elsnlfc_0:v2elsnlfc_21, v2elsnmrfc_0:v2elsnmrfc_21,
v2clrgstch_0:v2clrgstch_21, v2clrgwkch_0:v2clrgwkch_21)
# Listing the variable names to check our work:
#names(v13_col_sn)
# Export the result to a CSV file:
#write.csv(v13_col_sn, file = "v13_col_sn.csv")
# create subset of V-Dem data for 2018
v13_col_sn_2018 <- subset(v13_col_sn, year == 2018)
v13_col_sn_2018 <- v13_col_sn_2018 %>%
select(-matches("_17$|_18$|_19$|_20$|_21$")) # remove responses not relevant for Colombia
df2rm = c("v13", "v13_col", "v13_col_sn", "df2rm")
rm(list = df2rm)
# Load necessary libraries
library(dplyr)
library(tidyr)
library(knitr)
library(purrr)
library(kableExtra)
library(insight)
selected_vars <- grep("v2elsnlfc|v2elsnmrfc|v2clrgstch|v2clrgwkch", colnames(v13_col_sn_2018), value = TRUE)
selected_df <- v13_col_sn_2018 %>%
select(all_of(selected_vars))
summary_df <- selected_df %>%
pivot_longer(cols = everything()) %>%
mutate(row_id = gsub(".*_(\\d+)$", "\\1", name)) %>%
mutate(column_id = gsub(".*(v2elsnlfc|v2elsnmrfc|v2clrgstch|v2clrgwkch).*", "\\1", name)) %>%
pivot_wider(names_from = column_id, values_from = value) %>%
select(-name) %>%
mutate(row_id = as.numeric(row_id)) %>%
group_by(row_id) %>%
summarise(across(everything(), ~ifelse(all(is.na(.)), NA, first(na.omit(.))))) %>%
ungroup()
new_col_names <- c("Elections less free", "Elections more free", "Civil liberties stronger", "Civil liberties weaker")
new_row_names <- c(
"Rural", "Urban", "Less econ devt", "More econ devt", "Inside capital",
"Outside capital", "North", "South", "West", "East", "Civil unrest",
"Illicit activity", "Sparse pop.", "Remote", "Indigenous",
"Ruling party strong", "Ruling party weak"
)
# Rename columns and modify row_id variable
summary_table <- summary_df %>%
rename(
`Elections less free` = v2elsnlfc,
`Elections more free` = v2elsnmrfc,
`Civil liberties stronger` = v2clrgstch,
`Civil liberties weaker` = v2clrgwkch
) %>%
mutate(row_id = new_row_names[as.numeric(row_id) + 1])
summary_table
export_table(summary_table, format = "md")
library(sf)
col <- st_read("G:/Shared drives/snvdem/snvdem24/data/geospatial/2018pmq/BaseLayer/MGN_ANM_MPIOS.shp")
col <- col %>%
select(1:8)
library(readxl)
MGN18 <- read_excel("G:/Shared drives/snvdem/snvdem24/data/geospatial/MGN_ANM_MPIOS/MGN18.xls")
# We select only relevant variables for merging purposes.
# colnames(MGN18)
MGN18 <- MGN18 %>%
select(1:7)
# we merge the FID variable to our main shapefile
col <- merge(col, MGN18[, c("MPIO_CDPMP", "FID")], by = "MPIO_CDPMP", all.x = TRUE)
# municipal-level data for distance to capital city
IR18 <- read_excel("G:/Shared drives/snvdem/snvdem24/data/geospatial/2018pmq/0-1_Rurality/PANEL_CARACTERISTICAS_GENERALES(2021).xlsx")
colnames(IR18)[3] = "MPIO_CDPMP"
colnames(IR18)[7] = "Year"
IR18 <- IR18 %>%
filter(Year == 2018)
# this data set also contains important descriptive information (department, province) that we will hang onto
IR18 <- IR18[c("MPIO_CDPMP", "depto", "provincia", "indrural")]
# Because the import creates a numeric field for DANE code, we must convert this numeric variable to character and then assure each observation has the corresponding 5 digits
IR18$MPIO_CDPMP <- as.character(IR18$MPIO_CDPMP)
# Add a 0 before values with 4 digits only
IR18$MPIO_CDPMP <- ifelse(nchar(IR18$MPIO_CDPMP) == 4, paste0("0", IR18$MPIO_CDPMP), IR18$MPIO_CDPMP)
# Option #1: interact V-Dem with rural index score
#For example, a high rural index multiplied by a high proportion of V-Dem's response will produce correspondingly high scores. This may occur with the values for less free and fair elections for rural (.875) vs. urban (.125) areas.
# ([indrur0t1]*Rural)+((1-[indrur0t1])*Urban)
# .80*.875 + (1-.8)*.125
IR18 <- IR18 %>%
mutate(el_0t1x = (indrural*v13_col_sn_2018$v2elsnlfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnlfc_1)) %>%
mutate(em_0t1x = (indrural*v13_col_sn_2018$v2elsnmrfc_0)+((1-indrural)*v13_col_sn_2018$v2elsnmrfc_1)) %>%
mutate(cs_0t1x = (indrural*v13_col_sn_2018$v2clrgstch_0)+((1-indrural)*v13_col_sn_2018$v2clrgstch_1)) %>%
mutate(cw_0t1x = (indrural*v13_col_sn_2018$v2clrgwkch_0)+((1-indrural)*v13_col_sn_2018$v2clrgwkch_1))
# Min-max normalization function
nz <- function(x) {
return((x - min(x)) / (max(x) - min(x)))
}
# Create new variables with normalized values. Normalization may be important when comparing across variable scales.
df_nz <- data.frame(el_0t1xs = nz(IR18$el_0t1x),
em_0t1xs = nz(IR18$em_0t1x),
cs_0t1xs = nz(IR18$cs_0t1x),
cw_0t1xs = nz(IR18$cw_0t1x))
# Combine the normalized variables with the original dataframe
IR18 <- cbind(IR18, df_nz)
# For sf (R), merge this data to shapefile
col <- merge(col, IR18, by = "MPIO_CDPMP", all.x = TRUE)
summary_table
View(v13_col_sn_2018)
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)", "Presidential margin of victory (Registraduria)"))
mf <- flextable(vdem_op)
mf <- theme_box(mf)
mf <- merge_v(mf, j = ~ ind)
mf <- merge_v(mf, j = ~ Indicator)
mf
mfn <- merge_v(mf, j = ~ Indicator)
set_table_properties(mfn, layout = "autofit")
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
set_table_properties(mfn, layout = "autofit")
knitr::opts_chunk$set(echo = TRUE)
setwd("G:/Shared drives/snvdem/snvdem24/data/geospatial/2018pmq")
knitr::opts_chunk$set(echo = TRUE)
setwd("G:/Shared drives/snvdem/snvdem24/data/geospatial/2018pmq")
library(flextable)
library(dplyr)
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Municipal Value Added, or Departmental GDP (DNP)", "Municipal Value Added, or Departmental GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)", "Presidential margin of victory (Registraduria)"))
mf <- flextable(vdem_op)
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
set_table_properties(mfn, layout = "autofit")
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Mun. Value Added / Dept. GDP (DNP)", "Mun. Value Added / Dept. GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Ministry of Defense)", "Coca cultivation (Ministry of Defense/UNODC)",
"Population density (DANE)", "Access (Ministry of Transportation/Health)",
"Ethnic population (DANE)",
"Presidential margin of victory (Registraduria)", "Presidential margin of victory (Registraduria)"))
mf <- flextable(vdem_op)
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
set_table_properties(mfn, layout = "autofit")
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Mun. Value Added / Dept. GDP (DNP)", "Mun. Value Added / Dept. GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Min. Defense)", "Coca cultivation (Min. Defense/UNODC)",
"Population density (DANE)", "Access (Min. Transportation/Health)",
"Ethnic population (DANE)",
"Pres. margin of victory (RNEC)", "Pres. margin of victory (RNEC)"))
mf <- flextable(vdem_op)
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
set_table_properties(mfn, layout = "autofit")
library(officer)
set_caption(mfn,
caption = "Operationalization of V-Dem responses in Colombia",
style = "Table Caption",
autonum = run_autonum(seq_id = "tab", bkm = "tab1"))
library(flextable)
library(dplyr)
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Mun. Value Added / Dept. GDP (DNP)", "Mun. Value Added / Dept. GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Min. Defense)", "Coca cultivation (Min. Defense/UNODC)",
"Population density (DANE)", "Access (Min. Transportation/Health)",
"Ethnic population (DANE)",
"Pres. margin of victory (RNEC)", "Pres. margin of victory (RNEC)"))
mf <- flextable(vdem_op)
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
library(officer)
set_caption(mfn,
caption = "Operationalization of V-Dem responses in Colombia",
style = "Table Caption",
autonum = run_autonum(seq_id = "tab", bkm = "tab1"))
set_table_properties(mfn, layout = "autofit")
install.packages("perl")
library(flextable)
library(dplyr)
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Mun. Value Added / Dept. GDP (DNP)", "Mun. Value Added / Dept. GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Min. Defense)", "Coca cultivation (Min. Defense/UNODC)",
"Population density (DANE)", "Access (Min. Transportation/Health)",
"Ethnic population (DANE)",
"Pres. margin of victory (RNEC)", "Pres. margin of victory (RNEC)"))
mf <- flextable(vdem_op)
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
library(officer)
mfn <- set_caption(mfn,
caption = "Operationalization of V-Dem responses in Colombia",
style = "Table Caption",
autonum = run_autonum(seq_id = "tab", bkm = "tab1"))
mfn <- set_table_properties(mfn, layout = "autofit")
mfn <- set_flextable_defaults(fonts_ignore=TRUE)
mfn
mfn
library(flextable)
library(dplyr)
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Mun. Value Added / Dept. GDP (DNP)", "Mun. Value Added / Dept. GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Min. Defense)", "Coca cultivation (Min. Defense/UNODC)",
"Population density (DANE)", "Access (Min. Transportation/Health)",
"Ethnic population (DANE)",
"Pres. margin of victory (RNEC)", "Pres. margin of victory (RNEC)"))
mf <- flextable(vdem_op)
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
library(officer)
mfn <- set_caption(mfn,
caption = "Operationalization of V-Dem responses in Colombia",
style = "Table Caption",
autonum = run_autonum(seq_id = "tab", bkm = "tab1"))
mfn <- set_table_properties(mfn, layout = "autofit")
mfn
set_flextable_defaults(fonts_ignore=TRUE)
where perl.exe
library(flextable)
library(dplyr)
library(officer)
vdem_op <- data.frame(
ID = seq(0, 16, 1), stringsAsFactors = FALSE,
Response = c("Rural", "Urban",
"Less econ devt", "More econ devt",
"Inside capital", "Outside capital",
"North", "South", "West", "East",
"Civil unrest", "Illicit activity",
"Sparse pop.", "Remote",
"Indigenous",
"Ruling party strong", "Ruling party weak"),
Indicator = c("Rural Index (DANE)", "Rural Index (DANE)",
"Mun. Value Added / Dept. GDP (DNP)", "Mun. Value Added / Dept. GDP (DNP)",
"Geographic distance from center (DANE)", "Geographic distance from center (DANE)",
"Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)", "Six macro-regions (DANE)",
"Illegally armed groups (Min. Defense)", "Coca cultivation (Min. Defense/UNODC)",
"Population density (DANE)", "Access (Min. Transportation/Health)",
"Ethnic population (DANE)",
"Pres. margin of victory (RNEC)", "Pres. margin of victory (RNEC)"))
mf <- flextable(vdem_op)
mf <- theme_vanilla(mf)
mfn <- merge_v(mf, j = ~ Indicator)
mfn <- set_caption(mfn,
caption = "Operationalization of V-Dem responses in Colombia",
style = "Table Caption",
autonum = run_autonum(seq_id = "tab", bkm = "tab1"))
mfn <- set_table_properties(mfn, layout = "autofit")
mfn <- set_flextable_defaults(fonts_ignore=TRUE)
mfn
knitr::opts_chunk$set(echo = TRUE)
setwd("G:/Shared drives/snvdem/snvdem24/data/geospatial/2018pmq")
mf <- flextable(vdem_op) %>%
theme_vanilla(mf) %>%
merge_v(mf, j = ~ Indicator)
